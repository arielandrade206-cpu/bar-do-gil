<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Profissional de Comanda</title>

<style>
body{margin:0;font-family:Arial;background:#111;color:white}
header{background:#1e1e1e;padding:15px;text-align:center;font-size:20px;font-weight:bold}

.container{padding:10px}

input{padding:8px;border:none;border-radius:6px;width:100%}

button{padding:8px;border:none;border-radius:6px;margin:3px}

.criar{background:#4caf50;color:white;width:100%}
.editar{background:#ff9800;color:white}
.excluir{background:#f44336;color:white}
.abrir{background:#2196f3;color:white;width:100%}

.mesas{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
gap:10px;
margin-top:10px
}

.mesaCard{
background:#222;
padding:10px;
border-radius:10px;
text-align:center;
}

.item{display:flex;justify-content:space-between;margin:5px 0}

.addBtn{background:#4caf50;color:white}
.removeBtn{background:#f44336;color:white}

.total{font-weight:bold;margin-top:10px;font-size:18px}

.tabs{display:flex;overflow-x:auto;background:#222;margin-top:10px}
.tab{padding:10px;cursor:pointer;white-space:nowrap}
.tab.active{background:#ff9800}
</style>
</head>
<body>

<header>üî• Sistema de Comanda</header>

<div class="container">
<input id="novaMesa" placeholder="Nome da mesa">
<button class="criar" onclick="criarMesa()">Criar Mesa</button>

<div class="mesas" id="listaMesas"></div>
</div>

<div class="container" id="areaMesa" style="display:none">
<h3 id="tituloMesa"></h3>

<div class="tabs" id="tabs"></div>
<div id="itens"></div>

<h3>Itens da Mesa</h3>
<div id="listaItensMesa"></div>
<div class="total">Total: R$ <span id="totalMesa">0</span></div>
<button class="criar" onclick="fecharMesa()">Fechar Mesa</button>
</div>

<div class="container">
<h3>üìú Hist√≥rico</h3>
<div id="historico"></div>
<div class="total">Total Geral: R$ <span id="totalGeral">0</span></div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const firebaseConfig = {
apiKey: "AIzaSyBqezLaspgcS9B42CXOZl-FyY-SI5TphIk",
authDomain: "commanda-71512.firebaseapp.com",
databaseURL: "https://commanda-71512-default-rtdb.firebaseio.com",
projectId: "commanda-71512",
storageBucket: "commanda-71512.firebasestorage.app",
messagingSenderId: "789071833045",
appId: "1:789071833045:web:d28a7b2dddaa448304ff5c"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let mesaAtualId=null;
let mesaAtual=null;

const cardapio={

"Espetos":[
["Gado",6],
["Porco",6],
["Frango com osso",6],
["Frango com bacon",6],
["Cora√ß√£o",6],
["Calabresa apimentada",6],
["Calabresa defumada",6],
["P√£o de alho",6],
["Queijo com bacon",7]
],

"Refris":[
["Sukita laranja 1L",8],
["Sukita laranja 2L",11],
["It! Guaran√°",8],
["It! Coca",8],
["It! Laranja",8],
["Pepsi 2L",10],
["Pepsi 2L zero",10],
["Pepsi 1L",8],
["Guaran√° Lata",5],
["Guaran√° 1L",8],
["Guaran√° 2L",13],
["Sukita uva 2L",11],
["Coca lata",5],
["Coca 1L",9],
["Coca Ls",8],
["Coca 2L",14],
["Fys em geral",5],
["It em geral",4],
["Pepsi zero lata",4],
["Guaran√° zero",4],
["Sukita uva",4],
["Sukita laranja",4],
["Soda limonada",4]
],

"Cerveja Lata/Piriguete":[
["Skol",5],
["Subzero",5],
["Brahma",5],
["Amstel",5],
["Devassa",5],
["Lokal",4],
["Ant√°rtica",5],
["Crystal",5],
["Caracu",7],
["Original",6],
["Crystal baden",5],
["Black princess",5],
["Brahma zero",5],
["Brahma piriguete",5],
["Skol piriguete",5],
["Original piriguete",5],
["Crystal piriguete",5],
["Petra piriguete",5]
],

"Long Neck":[
["Heineken",9],
["Budweiser",8],
["Budweiser zero",8],
["Itaipava zero",8],
["Cabar√© lim√£o",8],
["Cabar√© frutas vermelhas",8]
],

"Cerveja 600ML":[
["Brahma 600ML",10],
["Skol 600ML",10],
["Subzero 600ML",8],
["Amstel 600ML",9],
["Crystal 600ML",6],
["Lokal 600ML",6],
["Heineken 600ML",12],
["Budweiser 600ML",10],
["Original 600ML",10],
["Antarctica 600ML",9],
["Itaipava 600ML",7],
["Itaipava Premium 600ML",9],
["Petra 600ML",8]
],

"Energ√©ticos / Outros":[
["Tnt 269ML",8],
["Tnt 473ML",10],
["Monster",14],
["Redbull",10],
["√Ågua mineral",3],
["√Ågua com g√°s",4],
["√Ågua de coco",7],
["H2o 500ML",7],
["H2o 1,5L",10],
["Skinka uva",5],
["Skinka laranja",5],
["Skinka morango",5],
["Beats frutas verdes",7]
],

"Por√ß√µes":[
["Mandioca 1",1],
["Mandioca 3",3],
["Mandioca 5",5],
["Mandioca 10",10],
["Feij√£o farofado 1",1],
["Feij√£o farofado 3",3],
["Feij√£o farofado 5",5],
["Feij√£o farofado 10",10],
["Vinagrete",0]
]

};

function criarMesa(){
const nome=document.getElementById("novaMesa").value;
if(!nome)return alert("Digite o nome");
const novaRef=push(ref(db,"mesas_abertas"));
set(novaRef,{nome:nome,itens:[],total:0});
document.getElementById("novaMesa").value="";
}

onValue(ref(db,"mesas_abertas"),snapshot=>{
const lista=document.getElementById("listaMesas");
lista.innerHTML="";
snapshot.forEach(child=>{
const mesa=child.val();
const id=child.key;
const div=document.createElement("div");
div.className="mesaCard";
div.innerHTML=`
<strong>${mesa.nome}</strong>
<br>Total: R$ ${mesa.total||0}
<br>
<button class="abrir">Abrir</button>
<button class="editar">‚úè</button>
<button class="excluir">üóë</button>
`;
div.querySelector(".abrir").onclick=()=>abrirMesa(id,mesa);
div.querySelector(".editar").onclick=()=>{
const novo=prompt("Novo nome:",mesa.nome);
if(novo)set(ref(db,"mesas_abertas/"+id+"/nome"),novo);
};
div.querySelector(".excluir").onclick=()=>{
if(confirm("Excluir mesa?"))remove(ref(db,"mesas_abertas/"+id));
};
lista.appendChild(div);
});
});

function abrirMesa(id,mesa){
mesaAtualId=id;
mesaAtual=mesa;
document.getElementById("areaMesa").style.display="block";
document.getElementById("tituloMesa").innerText=mesa.nome;
renderItensMesa();
renderCardapio();
}

function renderCardapio(){
const tabs=document.getElementById("tabs");
const itensDiv=document.getElementById("itens");
tabs.innerHTML="";
itensDiv.innerHTML="";
Object.keys(cardapio).forEach((cat,i)=>{
const t=document.createElement("div");
t.className="tab"+(i==0?" active":"");
t.innerText=cat;
t.onclick=()=>mostrar(cat,t);
tabs.appendChild(t);
});
mostrar(Object.keys(cardapio)[0],tabs.firstChild);
}

function mostrar(cat,element){
document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
element.classList.add("active");
const itensDiv=document.getElementById("itens");
itensDiv.innerHTML="";
cardapio[cat].forEach(item=>{
const d=document.createElement("div");
d.className="item";
d.innerHTML=`${item[0]} - R$ ${item[1]} <button class="addBtn">+</button>`;
d.querySelector("button").onclick=()=>addItem(item);
itensDiv.appendChild(d);
});
}

function addItem(item){
if(!mesaAtualId)return;
const novosItens=mesaAtual.itens||[];
novosItens.push({nome:item[0],valor:item[1]});
const novoTotal=(mesaAtual.total||0)+item[1];
set(ref(db,"mesas_abertas/"+mesaAtualId),{
nome:mesaAtual.nome,
itens:novosItens,
total:novoTotal
});
}

function renderItensMesa(){
onValue(ref(db,"mesas_abertas/"+mesaAtualId),snapshot=>{
mesaAtual=snapshot.val();
const lista=document.getElementById("listaItensMesa");
lista.innerHTML="";
(mesaAtual.itens||[]).forEach((item,index)=>{
const d=document.createElement("div");
d.className="item";
d.innerHTML=`${item.nome} - R$ ${item.valor} <button class="removeBtn">X</button>`;
d.querySelector("button").onclick=()=>{
mesaAtual.itens.splice(index,1);
mesaAtual.total-=item.valor;
set(ref(db,"mesas_abertas/"+mesaAtualId),mesaAtual);
};
lista.appendChild(d);
});
document.getElementById("totalMesa").innerText=mesaAtual.total||0;
});
}

function fecharMesa(){
push(ref(db,"historico"),{
nome:mesaAtual.nome,
total:mesaAtual.total,
data:new Date().toLocaleString()
});
remove(ref(db,"mesas_abertas/"+mesaAtualId));
document.getElementById("areaMesa").style.display="none";
}

onValue(ref(db,"historico"),snapshot=>{
let soma=0;
const hist=document.getElementById("historico");
hist.innerHTML="";
snapshot.forEach(child=>{
const d=child.val();
soma+=d.total;
const div=document.createElement("div");
div.innerText=`${d.nome} - R$ ${d.total}`;
hist.appendChild(div);
});
document.getElementById("totalGeral").innerText=soma;
});

</script>
</body>
</html>
