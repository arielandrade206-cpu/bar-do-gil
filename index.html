<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Comanda</title>

<style>
body{margin:0;font-family:Arial;background:#111;color:white;}
header{background:#1e1e1e;padding:12px;text-align:center;font-size:20px;font-weight:bold;}
.tabs{display:flex;overflow-x:auto;background:#222;}
.tab{padding:10px;cursor:pointer;white-space:nowrap;font-size:14px;}
.tab.active{background:#ff9800;}
.container{padding:10px;}
button{padding:8px;border:none;border-radius:6px;margin-left:5px;}
.addBtn{background:#4caf50;color:white;}
.removeBtn{background:#f44336;color:white;}
.mesaBtn{background:#2196f3;color:white;width:100%;margin-top:5px;}
.item{display:flex;justify-content:space-between;margin:5px 0;font-size:14px;}
.total{font-size:18px;margin-top:10px;font-weight:bold;}
input{padding:8px;border-radius:6px;border:none;width:100%;}
</style>
</head>
<body>

<header>ðŸ”¥ Sistema de Comanda</header>

<div class="container">
<input id="mesaNome" placeholder="Nome ou nÃºmero da mesa">
<button class="mesaBtn" onclick="criarMesa()">Criar / Abrir Mesa</button>
</div>

<div class="tabs" id="tabs"></div>
<div class="container" id="itens"></div>

<div class="container">
<h3>ðŸ§¾ Itens da Mesa</h3>
<div id="listaMesa"></div>
<div class="total">Total: R$ <span id="total">0</span></div>
<button class="addBtn" onclick="fecharConta()">Fechar Conta</button>
</div>

<div class="container">
<h3>ðŸ“œ HistÃ³rico</h3>
<div id="historico"></div>
<div class="total">Total Geral: R$ <span id="totalGeral">0</span></div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBqezLaspgcS9B42CXOZl-FyY-SI5TphIk",
  authDomain: "commanda-71512.firebaseapp.com",
  databaseURL: "https://commanda-71512-default-rtdb.firebaseio.com",
  projectId: "commanda-71512",
  storageBucket: "commanda-71512.firebasestorage.app",
  messagingSenderId: "789071833045",
  appId: "1:789071833045:web:d28a7b2dddaa448304ff5c"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let mesaAtual="";
let conta=[];
let total=0;

const cardapio = {

"Espetos":[
["Gado",6],["Porco",6],["Frango com osso",6],["Frango com bacon",6],
["CoraÃ§Ã£o",6],["Calabresa apimentada",6],["Calabresa defumada",6],
["PÃ£o de alho",6],["Queijo com bacon",7]
],

"Refris":[
["Sukita laranja 1L",8],["Sukita laranja 2L",11],["It! GuaranÃ¡",8],
["It! Coca",8],["It! Laranja",8],["Pepsi 2L",10],["Pepsi 2L zero",10],
["Pepsi 1L",8],["GuaranÃ¡ Lata",5],["GuaranÃ¡ 1L",8],["GuaranÃ¡ 2L",13],
["Sukita uva 2L",11],["Coca lata",5],["Coca 1L",9],
["Coca Ls",8],["Coca 2L",14],["Fys em geral",5],
["It em geral",4],["Pepsi zero lata",4],["GuaranÃ¡ zero",4],
["Sukita uva",4],["Sukita laranja",4],["Soda limonada",4]
],

"Cerveja Lata/Piriguete":[
["Skol",5],["Subzero",5],["Brahma",5],["Amstel",5],
["Devassa",5],["Lokal",4],["AntÃ¡rtica",5],["Crystal",5],
["Caracu",7],["Original",6],["Crystal baden",5],
["Black princess",5],["Brahma zero",5],["Brahma piriguete",5],
["Skol piriguete",5],["Original piriguete",5],
["Crystal piriguete",5],["Petra piriguete",5]
],

"Long Neck":[
["Heineken",9],["Budweiser",8],["Budweiser zero",8],
["Itaipava zero",8],["CabarÃ© limÃ£o",8],
["CabarÃ© frutas vermelhas",8]
],

"Cerveja 600ML":[
["Brahma 600ML",10],["Skol 600ML",10],["Subzero 600ML",8],
["Amstel 600ML",9],["Crystal 600ML",6],["Lokal 600ML",6],
["Heineken 600ML",12],["Budweiser 600ML",10],
["Original 600ML",10],["Antarctica 600ML",9],
["Itaipava 600ML",7],["Itaipava Premium 600ML",9],
["Petra 600ML",8]
],

"EnergÃ©ticos/Outros":[
["Tnt 269ML",8],["Tnt 473ML",10],["Monster",14],
["Redbull",10],["Ãgua mineral",3],["Ãgua com gÃ¡s",4],
["Ãgua de coco",7],["H2o 500ML",7],["H2o 1,5L",10],
["Skinka uva",5],["Skinka laranja",5],["Skinka morango",5],
["Beats frutas verdes",7]
],

"PorÃ§Ãµes":[
["Mandioca 1",1],["Mandioca 3",3],["Mandioca 5",5],["Mandioca 10",10],
["FeijÃ£o farofado 1",1],["FeijÃ£o farofado 3",3],
["FeijÃ£o farofado 5",5],["FeijÃ£o farofado 10",10],
["Vinagrete",0]
]

};

const tabs=document.getElementById("tabs");
const itensDiv=document.getElementById("itens");

Object.keys(cardapio).forEach((cat,i)=>{
  let t=document.createElement("div");
  t.className="tab"+(i==0?" active":"");
  t.innerText=cat;
  t.onclick=()=>mostrar(cat,t);
  tabs.appendChild(t);
});

function mostrar(cat,element){
  document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
  element.classList.add("active");
  itensDiv.innerHTML="";
  cardapio[cat].forEach(item=>{
    let d=document.createElement("div");
    d.className="item";
    d.innerHTML=`${item[0]} - R$ ${item[1]} 
    <button class="addBtn">+</button>`;
    d.querySelector("button").onclick=()=>addItem(item[0],item[1]);
    itensDiv.appendChild(d);
  });
}

window.criarMesa=function(){
  mesaAtual=document.getElementById("mesaNome").value;
  alert("Mesa aberta: "+mesaAtual);
}

function addItem(nome,valor){
  conta.push({nome,valor});
  total+=valor;
  atualizar();
}

function atualizar(){
  const lista=document.getElementById("listaMesa");
  lista.innerHTML="";
  conta.forEach((item,i)=>{
    let d=document.createElement("div");
    d.className="item";
    d.innerHTML=`${item.nome} - R$ ${item.valor}
    <button class="removeBtn">X</button>`;
    d.querySelector("button").onclick=()=>{
      total-=item.valor;
      conta.splice(i,1);
      atualizar();
    };
    lista.appendChild(d);
  });
  document.getElementById("total").innerText=total;
}

window.fecharConta=function(){
  if(!mesaAtual) return alert("Crie uma mesa");
  push(ref(db,"historico"),{
    mesa:mesaAtual,
    total:total,
    data:new Date().toLocaleString()
  });
  conta=[];
  total=0;
  atualizar();
}

onValue(ref(db,"historico"),snapshot=>{
  const hist=document.getElementById("historico");
  hist.innerHTML="";
  let soma=0;
  snapshot.forEach(c=>{
    let d=c.val();
    soma+=d.total;
    let div=document.createElement("div");
    div.innerText=`Mesa ${d.mesa} - R$ ${d.total}`;
    hist.appendChild(div);
  });
  document.getElementById("totalGeral").innerText=soma;
});

mostrar("Espetos",document.querySelector(".tab"));

</script>

</body>
</html>
